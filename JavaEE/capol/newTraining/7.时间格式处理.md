项目中，发现一个有趣的地方

连接数据库时实现的dataSource.url为：

```yml
url: jdbc:mysql://127.0.0.1:3306/db_training?characterEncoding=utf8&useSSL=false&serverTimezone=UTC&rewriteBatchedStatements=true
```

可以看到serverTimezone=UTC，此时会与正常的 北京时间 相差8小时，故数据库存储的为操作时间-8h，而在渲染至前端页面时，为避免前端的时间处理，统一在后台处理好时间格式再返给前端；

即如果是列表，可以在dto转vo时将时间由date转为string格式，确保样式

```java
package com.capol.training.newemployee.common.helpers.utils;

import com.capol.base.utils.CollectionUtil;
import com.capol.base.utils.ObjectUtil;
import com.capol.training.newemployee.common.helpers.converter.ObjectFieldConverter;

import java.util.ArrayList;
import java.util.List;

/**
 * @author fuzihao
 * @date 2019/8/7 11:34
 */
public class TrainingBeanUtils {
    /**
     * dto list转为 vo list
     * @param dtoList
     * @param object
     * @param <DTO>
     * @param <VO>
     * @return
     * @throws Exception
     */
    public static <DTO,VO> List<VO> dtoListToVoList(List<DTO> dtoList,Class<VO> object) throws Exception {
        List<VO> voList=new ArrayList<>();
        if(CollectionUtil.isNotEmpty(dtoList)){
            for(DTO dto:dtoList){
                VO vo=object.newInstance();
                ObjectUtil.copyPropertiesByCglib(dto,vo, ObjectFieldConverter.getInstance());
                voList.add(vo);
            }
        }
        return voList;
    }
}

```

其中ObjectUtils如下

```java
public class ObjectUtil {    
    //通过cglib复制实体属性
    public static void copyPropertiesByCglib(Object orig, Object dest, Converter converter) throws Exception {
        boolean isUseConverter = converter != null;
        BeanCopier beanCopier = BeanCopier.create(orig.getClass(), dest.getClass(), isUseConverter);
		beanCopier.copy(orig, dest, converter);
	}
}
```

而ObjectFieldConverter如下

```java
import com.capol.base.utils.DateUtil;
import net.sf.cglib.core.Converter;

import java.util.Date;

/**
 * @author fuzihao
 * @date 2019/8/7 15:01
 */
public class ObjectFieldConverter implements Converter {
    private ObjectFieldConverter() {
    }

    private static class SingletonInstance {
        private static final ObjectFieldConverter INSTANCE = new ObjectFieldConverter();
    }

    public static ObjectFieldConverter getInstance() {
        return SingletonInstance.INSTANCE;
    }

    /**
     * value 源对象属性，
     * target 目标对象属性类，
     * context 目标对象setter方法名；
     * <p>
     * 注意：一旦使用Converter，BeanCopier只使用Converter定义的规则去拷贝属性，所以在convert方法中要考虑所有的属性
     *
     * @param value
     * @param target
     * @param context
     * @return
     */
    @Override
    public Object convert(Object value, Class target, Object context) {
        if (value instanceof Date) {
            return DateUtil.DateTimeToString((Date) value);
        } else {
            return value;
        }
    }
}
```

通过单例模式创建转换器，其`convert`过程主要是将日期格式转换为string

其中DateUtils如下

```java
public static String DateTimeToString(Date date) {
    return date == null ? null : DateToString(date, "yyyy-MM-dd HH:mm:ss");
}
public static String DateToString(Date date, String pattern) {
    String strDateTime = null;
    SimpleDateFormat formater = new SimpleDateFormat(pattern);
    strDateTime = date == null ? null : formater.format(date);
    return strDateTime;
}
```

