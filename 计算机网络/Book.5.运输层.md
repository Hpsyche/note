# 运输层协议概述

## 进程之间的通信

运输层向它上面的应用层提供通信服务。

运输层有一个重要的功能----复用和分用，

复用：在发送方不同的应用进程都可以使用同一个运输层协议传送数据（当然需要加上适当的首部）

分用：接收方的运输层在剥去报文的首部后能够把这些数据正确交付目的应用进程

<u>运输层提供应用进程间的逻辑通信；</u>

逻辑通信指：从应用层来看，只要把应用层报文交给下面的运输层，运输层就可以把报文传送到对方的运输层。好像这种通信就是沿水平方向直接传送数据，但事实上这两个运输层之间并没有一条水平方向的物理连接。数据的传送是沿着图上的虚线方向（经过多个层次）传送的。

逻辑通信：“好像是这样通信，但事实上并非真的这样通信”

![](D:\Work\TyporaNotes\note\计算机网络\pict\运输层提供应用程序间的逻辑通信.png)

<u>网络层为主机之间提供逻辑通信，而运输层为应用程序之间提供端到端的逻辑通信</u>

<u>运输层还要对收到的报文进行差错检测。在网络层，IP数据报首部中的检验和字段，只检验首部是否出现差错而不检查数据部分。</u>

<u>运输层向高层用户屏蔽了下面网络核心的细节，它使应用进程看见的就是好像两个运输层实体之间有一条端到端的逻辑通信信道。</u>

![](D:\Work\TyporaNotes\note\计算机网络\pict\运输层协协议和网络层协议的主要区别.png)

## 运输层的两个主要协议

* 用户数据报协议UDP （User Datagram Protocol）
* 传输控制协议TCP（Transmission Control Protocol）

## 运输层的端口

为了使运行不同操作系统的计算机的应用进程能够互相通信，就必须用统一的方法对 TCP/IP 体系的应用进程进行标志。 

解决这个问题的方法就是在运输层使用协议端口号(protocol port number)，或通常简称为端口(port)。

<u>端口：应用层的各种协议进程与运输实体进行层间交互的一种地址</u>

### 常用的熟知端口号

FTP:21

TELNET:23

SMTP:25

DNS:53

HTTP:80

HTTPS:443

### TCP的端口

**端口用一个16位端口号进行标志（65535个不同端口**）

<u>端口号只具有本地意义</u>，即端口号只是为了标志本计算机应用层中的各进程。在因特网中不同计算机的相同端口号是没有联系的。

### 三类端口

（蜀登客）

* 熟知端口号
* 登记端口号
* 客户端口号或短暂端口号

![](D:\Work\TyporaNotes\note\计算机网络\pict\三类端口.png)



# 用户数据报协议UDP

## UDP概述

（面拥无尽手信）

* UDP是无连接的
* UDP使用尽最大努力交付，即不可靠交付
* UDP是面向报文的
* UDP没有拥塞控制
* UDP支持一对一、一对多、多对一和多对多的交互通信
* UDP的首部开销小

![](D:\Work\TyporaNotes\note\计算机网络\pict\UDP是面向报文的.png)

![](D:\Work\TyporaNotes\note\计算机网络\pict\UDP基于端口的分用.png)

# 传输控制协议TCP概述

## TCP最主要的特点

* TCP 是面向连接的运输层协议。
* 每一条 TCP 连接只能有两个端点(endpoint)，每一条 TCP 连接只能是点对点的（一对一）。 
* TCP 提供可靠交付的服务。
* TCP 提供全双工通信。
* 面向字节流。 

## TCP的连接

TCP连接的端点叫做套接字或插口。若IP地址是192.3.4.5，而端口号是80，那么得到的套接字就是（192.3.4.5:80)。即

​	套接字 socket = (IP地址 ：端口号)

每一条TCP连接唯一地被通信两端的两个端点（即两个套接字）所确定，即：

​	TCP连接 ::= {socket1,socket2} = {(IP1:port1),(IP2,port2)}



# 可靠传输的工作原理

停止等待协议！

![](D:\Work\TyporaNotes\note\计算机网络\pict\停止等待协议.png)

# 本章的重要概念

* 运输层有两个主要的协议：TCP和UDP。它们都有复用和分用，以及检错的功能。
* 当运输层采用面向连接的<u>TCP协议</u>时，尽管<u>下面的网络是不可靠的（只提供尽最大努力服务），但这种逻辑通信信道就相当于一条全双工通信的可靠信道。</u>
* 当运输层采用无连接的UDP协议时，这种逻辑通信信道仍然是一条不可靠信道。







